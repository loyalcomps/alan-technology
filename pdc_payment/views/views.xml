<odoo>
    <data>
        <record id="pdc_account_payment_form_inherit" model="ir.ui.view">
            <field name="name">account.payment.pdc.form</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                <xpath expr="//header/button[@name='action_post']" position="after">
                    <button name="action_collect_pdc" string="Collect" type="object" class="oe_highlight"
                            attrs="{'invisible': ['|', ('sub_cheque_status', 'not in', ('deposited', 'issued')), ('bank_cheque', '=', False)]}"
                            data-hotkey="v"/>
                    <button name="action_cancel_pdc" string="Cancel PDC" type="object" class="oe_highlight"
                            attrs="{'invisible': ['|', ('sub_cheque_status', 'not in', ('in_cheque_box', 'issued')), ('bank_cheque', '=', False)]}"
                            data-hotkey="v"/>
                    <button name="action_refuse_pdc" string="Refuse" type="object" class="oe_highlight"
                            attrs="{'invisible': ['|', ('sub_cheque_status', '!=', 'collected'), ('bank_cheque', '=', False)]}"
                            data-hotkey="v"/>
                    <button name="action_deposit_pdc" string="Deposit" type="object" class="oe_highlight"
                            attrs="{'invisible': ['|', ('sub_cheque_status', 'not in', ('in_cheque_box', 'issued')), ('bank_cheque', '=', False)]}"
                            data-hotkey="v"/>
                </xpath>
                <xpath expr="//header/button[@name='action_draft']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|', ('state', 'not in', ('posted',
                        'cancel')),('sub_cheque_status', 'in', ('refused','collected'))]}
                    </attribute>
                </xpath>
                <field name="journal_id" position="replace">
                    <field name="journal_id" domain="[('id', 'in', available_journal_ids)]"
                           attrs="{'readonly': [('state', '!=', 'draft')],'invisible': [('branch_cheque', '=', True)]}" string="Journal"/>
                    <field name="journal_id" domain="[('id', 'in', available_journal_ids)]"
                           attrs="{'readonly': [('state', '!=', 'draft')],'invisible': [('branch_cheque', '=', False)]}"
                           string="Branch Journal"/>
                </field>

                <xpath expr="//group[@name='group2']/field[@name='journal_id']" position="before">
                    <field name="journal_type" invisible="1"/>
                    <field name="bank_cheque" attrs="{'invisible': [('journal_type', '=', 'cash')]}"/>
                    <field name="branch_cheque" attrs="{'invisible': [('bank_cheque', '=', False)]}"/>
                    <field name="branch_id"/>
                </xpath>
                <xpath expr="//group[@name='group2']/field[@name='payment_method_line_id']" position="before">
                    <field name="branch_account_id" attrs="{'invisible': [('branch_cheque', '=', False)]}"/>
                    <field name="ho_account_id" attrs="{'invisible': [('branch_cheque', '=', False)]}"/>
                    <field name="bank_journal_id" attrs="{'invisible': [('branch_cheque', '=', False)]}"/>
                </xpath>
                <xpath expr="//group[@name='group1']/field[@name='payment_type']" position="after">
                    <field name="not_a_contact"
                           attrs="{'readonly':[('state', '!=', 'draft')], 'invisible':[('is_internal_transfer', '=', True)]}"/>
                </xpath>
                <xpath expr="//group[@name='group1']/field[@name='partner_id'][1]" position="attributes">
                    <attribute name="attrs">{'readonly':[('state', '!=', 'draft')],'invisible':['|', '|',
                        ('not_a_contact','=',True), ('partner_type','!=','customer'), ('is_internal_transfer', '=',
                        True)]}
                    </attribute>
                </xpath>
                <xpath expr="//group[@name='group1']/field[@name='partner_id'][2]" position="attributes">
                    <attribute name="attrs">{'readonly':[('state', '!=', 'draft')],'invisible':['|', '|',
                        ('not_a_contact','=',True), ('partner_type','!=','supplier'), ('is_internal_transfer', '=',
                        True)]}
                    </attribute>
                </xpath>
                <xpath expr="//group[@name='group1']/field[@name='partner_id'][2]" position="after">
                    <field name="partner_id" context="{'default_is_company': True}" string="Partner"
                           attrs="{'readonly':[('state', '!=', 'draft')], 'invisible':['|', ('not_a_contact','=', False), ('is_internal_transfer', '=', True)]}"/>
                </xpath>
                <xpath expr="//sheet" position="inside">
                    <h3 attrs="{'invisible': [('not_a_contact', '=', False)]}">Payment Order Information</h3>
                    <field name="employee_payment_line_ids" attrs="{'invisible': [('not_a_contact', '=', False)]}">
                        <tree string="Payment Order Information" editable="bottom">
                            <field name="account_id" options="{'no_create': True}"
                                   domain="[('deprecated', '=', False), ('company_id', '=', parent.company_id), ('is_off_balance', '=', False)]"/>
                            <field name="analytic_account_id" invisible="1"/>
                            <field name="analytic_distribution" widget='analytic_distribution'/>
                            <field name="company_id"/>
                            <field name="company_currency_id" invisible="1"/>
                            <field name="memo"/>
                            <field name="payment_amount"/>
                            <field name="tax_ids" widget="many2many_tags" options="{'no_create': True}"/>
                            <field name="price_tax" invisible="1"/>
                            <field name="total"/>
                        </tree>
                    </field>

                    <group name="cheque_info" string="Cheque Information"
                           attrs="{'invisible': [('bank_cheque', '=', False)]}">
                        <group>
                            <field name="bank_id" attrs="{'required': [('bank_cheque', '=', True)]}"/>
                            <field name="cheque_reference"
                                   attrs="{'required': [('bank_cheque', '=', True)], 'readonly': [('state', '!=', 'draft')]}"/>
                            <field name="cheque_returned"/>
                        </group>
                        <group>
                            <field name="effective_date"
                                   attrs="{'required': [('bank_cheque', '=', True)], 'readonly': [('state', 'not in', ('draft'))]}"
                                   string="Cheque Due date"/>
                            <field name="cheque_collection_date"/>
                            <field name="sub_cheque_status" readonly="1" force_save="1"
                                   attrs="{'invisible':[('is_internal_transfer', '=', True)]}"/>
                        </group>
                    </group>
                </xpath>

            </field>
        </record>

        <record id="account_payment_inherit_pdc_form" model="ir.ui.view">
            <field name="name">account.payment.pdc.form</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="branch.view_account_payment_form_inherit_branch"/>
            <field name="arch" type="xml">
                <field name="branch_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
            </field>
        </record>
    </data>
</odoo>